## Задание

Необходимо реализовать простейшую систему классификации изображений на основе сверточных нейронных сетей.

1. Реализовать систему классификации согласно описанию, используя не менее трех различных архитектур нейронной сети.
2. Сравнить качество работы, скорость и количество потребляемой памяти для каждой архитектуры.

Система должна загружать изображение с диска, преобразовывать в нужный для обработки моделью нейронной сети формат
(тензор), выполнять предобработку, если требуется (например, изменение размера и нормирование), затем обрабатывать
с помощью нейронной сети и выводить результат (номер класса, название, его вероятность для первых 5 наиболее
вероятных классов).

Каждую модель необходимо протестировать на собственном наборе из не менее чем 50 изображений (можно использовать
любые изображения, но не те, которые использовались для обучения), в качестве метрик использовать top-1 accuracy
и top-5 accuracy.

Используемые в работе модели: VGG16 с батч-нормализацией, GoogLeNet, ResNet50

## Теория

Все три нейронные сети в года выпуска произвели фурор в качестве классификации изображений на датасете Imagenet. Наиболее
\"прямолинейной\" из троих является сеть VGG16. Основной её недостаток - большой размер (138.4 миллионов параметров).
Семейство архитектур VGG повышало качество предсказания за счёт углубления сети и добавления слоёв пакетной нормализации.

![Alt text](images/vgg16.png?raw=true "Архитектура сети VGG16")

Такой подход возможен, однако рано или поздно по мере углубления всё острее будет вставать проблема
затухания градиентов, а из-за чего модель будет обучаться слишком долго. Также бездумное увеличение количества
слоёв значительно повышает объём модели. Создатели архитектур GoogLeNet и ResNet предложили свои уникальные подходы
для решения данных проблем.

<br />

![Alt text](images/GoogLeNet.png?raw=true "Архитектура сети GoogLeNet")

В GoogLeNet используются Inception блоки, которые состоят из параллельных свёрток, меньшего размера чем в VGG,
при это свётки в самом блоке также отличаются размером. Это позволило сократить количество хранимых параметров и параллельно
выделять признаки разного масштаба на изображениях. Также у представленной сети было несколько выходов, которые
необходимы для предотвращения затухания градиентов путём их распространения с более ранних этапов

![Alt text](images/inception_block.png?raw=true "Структура блока Inception")

Создатели ResNet предложили свои блоки - с остаточной связью. Данные "проскакивали" через несколько слоёв нейронной сети
и конкатенировались с данными, прошедшими преобразования. Такие пропуски позволяли эффективно распространяться по
сети градиентам.

Архитектура сети ResNet50:

![Alt text](images/ResNet50.png?raw=true "Архитектура сети ResNet50")

Структура блока с остаточной связью:

![Alt text](images/Residual_block.png?raw=true "Блок с остаточной связью")

## Реализация

Воспользуемся реализацией сетей, доступными в библиотеке torchvision. Для каждой сети загрзим веса, полученные при
обучении на датасете Imagenet.

Соберём 50 фотографий классов, представленных в датасете Imagenet для проверки качества предсказания сетей.
Представленный классы: cassette, castle, cup, goose, jellyfish, Labrador retriever, laptop, llama, mask, park bench,
pillow, pizza, school bus, sturgeon, teapot, volcano. Прежде чем передавать данные на вход сетям, применем препроцессинг,
рекомендованный для обработки фотографий в сооствествии с правилами Imagenet. Препроцессинг включает в себя изменение
размера до 256x256 пикселей, обрезка по центру до 224x224 пикселей и нормализация пикселей по каналам со средними
\[0.485, 0.456, 0.406\] и стандартным отклонением \[0.229, 0.224, 0.225\].

## Результаты

| Архитектура        | Top-1 accuracy | Top-5 accuracy | Время работы | Используемая память | 
| ------------------ | ---------------| -------------- | ------------ | ------------------- | 
| VGG16 + batch norm | 0.7959         | 0.9388         | 14.7 s       | 2.53 GB             |
| GoogLeNet          | 0.6531         | 0.8979         | 5.33 s       | 0.93 GB             |
| ResNet50           | 0.6531         | 0.8776         | 6.25 s       | 1.06 GB             |



## Выводы
В результате проделанной работы была реализована программа по анализу качества классификации изображений тремя сетями:
VGG16 с пакетной нормализацией, GoogLeNet и ResNet50. В процессе вычисления метрик и затрачиваемых ресурсов была
обнаружена уникальная ситуация: GoogLeNet и ResNet50, сети, которые должны были значительно превосходить по качеству
VGG16, показали большое оставание. Одной из возможных причин таких результатов может являться отличие собранного
набора данных, по сравнению с изображениями, представленными в Imagenet.
